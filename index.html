<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Detect Local IP</title>
<style>
body { font-family: Arial; padding: 20px; }
button {
  width: 100%;
  padding: 18px;
  font-size: 19px;
  border-radius: 10px;
  background: #007aff;
  color: white;
  border: none;
}
#ip {
  margin-top: 20px;
  font-size: 22px;
  text-align: center;
}
</style>
</head>
<body>

<h2 style="text-align:center;">My Local IP</h2>

<div id="ip">Press the button to get your local IP</div>

<button onclick="getIP()">Get My Local IP</button>

<script>
function getIP() {
    const ipBox = document.getElementById("ip");
    ipBox.innerHTML = "Detecting your IP… ⏳";

    const pc = new RTCPeerConnection({iceServers: []});
    pc.createDataChannel("");
    pc.createOffer().then(o => pc.setLocalDescription(o));

    pc.onicecandidate = (event) => {
        if (!event || !event.candidate) return;

        const cand = event.candidate.candidate;
        const match = cand.match(/([0-9]{1,3}(\.[0-9]{1,3}){3})/);

        if (match) {
            const ip = match[1];
            ipBox.innerHTML = "Your Local IP: <b>" + ip + "</b>";
            pc.close();
        }
    };

    // Fail-safe timeout
    setTimeout(() => {
        if (ipBox.innerHTML.includes("Detecting")) {
            ipBox.innerHTML = "❌ Failed to get IP (iOS blocked WebRTC leak)";
        }
    }, 5000);
}
</script>

</body>
</html>
